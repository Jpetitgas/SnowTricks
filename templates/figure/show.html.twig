{% extends 'base.html.twig' %}

{% form_theme formView 'bootstrap_4_layout.html.twig' %}

{% block title %}Hello FigureController!
{% endblock %}
{% block stylesheets %}
	{{ parent() }}
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick-theme.min.css" integrity="sha512-17EgCFERpgZKcm0j0fEq1YCJuyAWdz9KUtv1EjVuaOz8pDnh/0nZxmU6BBXwaaxqoi9PQXnRWqlcDB027hgv9A==" crossorigin="anonymous"/>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.min.css" integrity="sha512-yHknP1/AwR+yx26cB1y0cjvQUMvEa2PFzt1c9LlS4pRQ5NOTZFWbhBig+X9G9eYW/8m0/4OXNx8pxJ6z57x0dw==" crossorigin="anonymous"/>
{% endblock %}

{% block body %}
	<div class="container ">
		{% if app.user %}
			<div class="row justify-content-end">
				<div class="col-1">
					<a href="{{path("figure_edit", {'slug': figure.slug}) }}">
						<i class="fas fa-pencil-alt"></i>
					</a>
				</div>
				<div class="col-1">
					<a href="{{path("figure_delete", {'slug': figure.slug}) }}">
						<i class="fas fa-trash-alt"></i>
					</a>
				</div>
			</div>
		{% endif %}

		{% for item in figure.images %}
			{% if item.main %}
				<img src="\images\main\{{item.name}}" class="img-thumbnail" alt="image de la figure">
			{% endif %}
		{% endfor %}
		<div class="row">
			<div class="col-6">

				{% if figure.images %}
					<div class="slider">

						{% for image in figure.images %}
							<div class="col-12">
								<img src="\images\main\{{image.name}}" class="img-thumbnail">
							</div>
						{% endfor %}
					</div>

				{% endif %}

			</div>
			<div class="col-6">

				{% if figure.images %}
					<div class="slider">

						{% for media in figure.media %}
							<div class="col-12" style="height=50px">
								<iframe  width="150" src="https://www.youtube.com/embed/{{media.lien}}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
								
							</div>
						{% endfor %}
					</div>

				{% endif %}
			</div>
		</div>

		<div class=" row">
			<p class="p-3 mb-2 text-justify" style="white-space:pre-line">{{figure.description}}</p>
		</div>
		<div class="row justify-content-around p-3 mb-2">
			<div class="col">
				<h4>
					<span class="badge badge-info">Redigé par :
						{{figure.writer.username}}
						({{figure.date | date ("d/m/Y")}})</span>
				</h4>
			</div>
			{% if figure.datemod is not null %}
				<div class="col">
					<h4>
						<span class="badge badge-warning">Derniere modification le :
							{{figure.datemod | date ("d/m/Y")}}</span>
					</h4>
				</div>

			{% endif %}
			<div class="col">
				<h4>
					<span class="badge badge-secondary mr-0">{{figure.type.description}}</span>
				</h4>
			</div>
		</div>
		{% if app.user %}
			<div class="row  align-items-center">
				<div class="col-2">
					<img src="\images\main\{{app.user.portrait.name}}" class="rounded-circle" width="100">
				</div>
				<div class="col-8">
					{{ form_start(formView) }}

					{{ form_widget(formView) }}
				</div>
				<div class="col-2">
					<button type="submit" class="btn btn-lg btn-primary center">Register</button>
				</div>
				{{ form_end(formView) }}

			</div>
		{% else %}
			<div class="row">
				<h5>Vous devez etre connecté pour laisser un commentaire:
					<a class="btn  btn-success" href="{{ path ('app_login')}}">Sign in</a>
				</h5>
			</div>
		{% endif %}
		<div class="row justify-content-around p-3 mb-2">
			<h2>COMMENTAIRES</h2>
		</div>
		{% for comment in comments %}
			<div class="card mb-2">
				<div class="card-body p-2 p-sm-3">
					<div class="media forum-item">
						<a href="#" data-toggle="collapse" data-target=".forum-content"><img src="\images\main\{{comment.writer.portrait.name}}" class="mr-3 rounded-circle" width="50" alt="User"/></a>
						<div class="media-body">
							<p class="text-light text-justify">
								{{comment.content}}
							</p>
						</div>
					</div>
				</div>
			</div>
		{% endfor %}
	
	<div class="row justify-content-center">
			{% set pages = (total/limit)| round(0, 'ceil') %}
			<ul class="pagination">
				<li class="{{(page==1)?'page-item disabled':''}}">
					<a class="page-link" href="{{(page>1) ? '?page='~(page-1):''}}">
						<i class="fas fa-angle-left"></i>
					</a>
				</li>
				

				{% for item in 1..pages %}
					<li class="{{(page==item)?'page-item active':''}}">
						<a class="page-link" href="?page={{item}}">{{item}}
						</a>
					</li>

				{% endfor %}
				<li class="{{(page==pages)?'page-item disabled':''}}">
					<a class="page-link" href="{{(page<pages) ? '?page='~(page+1):''}}">
						<i class="fas fa-angle-right"></i>
					</a>
				</li>
			</ul>
			
		</div>
		<div class="row justify-content-end">
				<button id="togg2" ><i class="fa fa-chevron-up" aria-hidden="true" ></i></button>	
			</div>
	
	</div>
	</div>
{% endblock %}
{% block javascripts %}
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.min.js" integrity="sha512-HGOnQO9+SP1V92SrtZfjqxxtLmVzqZpjFFekvzZVWoiASSQgSr4cw9Kqd2+l8Llp4Gm0G8GIFJ4ddwZilcdb8A==" crossorigin="anonymous"></script>
	<script type="text/javascript">
		$('.slider').slick({infinite: true, slidesToShow: 3, slidesToScroll: 3});
	</script>
{% endblock %}
